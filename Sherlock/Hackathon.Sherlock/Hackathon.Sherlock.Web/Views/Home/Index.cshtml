@{
    ViewBag.Title = "Index";
}

<link href='http://fonts.googleapis.com/css?family=Coda:400,800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Coda+Caption:800' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Pathway+Gothic+One' rel='stylesheet' type='text/css'>

<h2>Index</h2>
<div class="container">

    <div id="players" class="clearfix">
		<div id="player1">
			<div id="player_avatar_0" class="avatar"></div>
			<form>
				<textarea rows="3"></textarea>
				<input type="submit" class='btn btn-primary'/>
			</form>
		</div>
		<div id="player2">
			<div id="player_avatar_1" class="avatar"></div>
			<form>
				<textarea rows="3"></textarea>
				<input type="submit" class='btn btn-primary'/>
			</form>
		</div>
		<div id="player3">
			<div id="player_avatar_2" class="avatar"></div>
			<form>
				<textarea rows="3"></textarea>
				<input type="submit" class='btn btn-primary'/>
			</form>
		</div>
		<div class="sherlock">
			<div class="avatar"></div>
			<form>
				<textarea rows="3"></textarea>
				<input type="submit" class='btn btn-primary'/>
			</form>
		</div>
	</div>
	<div id="board" class="">
		<div id="selection" class="">
			<div class="row  header">
				<div class="cell">People</div>
				<div class="cell">Places</div>
			</div>
			<div class="row ">
				<div id="answer_" class="cell"><span>$</span>200</div>
				<div id="answer_" class="cell"><span>$</span>200</div>
			</div>
			<div class="row ">
				<div id="answer_" class="cell"><span>$</span>400</div>
				<div id="answer_" class="cell"><span>$</span>400</div>
			</div>
			<div class="row ">
				<div id="answer_" class="cell"><span>$</span>600</div>
				<div id="answer_" class="cell"><span>$</span>600</div>
			</div>
			<div class="row ">
				<div id="answer_" class="cell"><span>$</span>800</div>
				<div id="answer_" class="cell"><span>$</span>800</div>
			</div>
		</div>
		<div id="presentor" class="answer21 hide">
			<div id="challenge">
			</div>
			<div id="response">
			</div>
		</div>
	</div>
    <div>
        <input type="text" id="message" />
        <input type="button" id="sendmessage" value="Send" />
        <input type="button" id="newChallenge" value="New Challenge" />
        <input type="button" id="startGame" value="Start Game" />
        <input type="button" id="getCategories" value="Get Categories" />
        <input type="hidden" id="displayname" />

        <input type="button" id="getCurrentCategory" value="Get Current Category" />


        <div>select category:
            <input type="text" id="category" />
            <input type="button" id="setCategory" value="Set Category" />
        </div>
        <div id="challenge"></div>
        <ul id="discussion">
        </ul>

        <div>Response:
            <input type="text" id="response" />
            <input type="button" id="sendResponse" value="Send Response" />
        </div>
    



    </div>


</div>


<input id="sessionId" type="hidden" value="@Session.SessionID" />

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-1.1.2.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->



    <script>
        $(function () {
            // Reference the auto-generated proxy for the hub.  
            var game = $.connection.gameHub;
            // Create a function that the hub can call back to display messages.
            game.client.handleResponse = function (sessionId, response) {              
                $('#discussion').append('<li><strong>' + htmlEncode(sessionId)
                    + '</strong>: ' + htmlEncode(response) + '</li>');
            };


            game.client.newChallenge = function (challenge) {

                $('#challenge').html(challenge);
            };

            game.client.isGameFull = function (value) {
                //do stuff is game is full
            }


            game.client.startGame = function() {
                //do stuff is game is full
                //TODO
            }

            game.client.loadCategories = function (categories) {
                $('#challenge').html(categories);
            }

            game.client.getCurrentCategory = function (currentCategory) {
                $('#challenge').html(currentCategory);
            }


            //
            game.client.getUserResponse = function (sessionId,response) {
                $('#myResponse').html(response);
            }

            //
            game.client.getWinner = function (sessionId) {
                $('#challenge').html("The Winner is " + sessionId);
            }

            game.client.setUserStatus = function (status) {
                user.canPlay = status;
                console.log(user.canPlay);
            }
 
            
            $('#message').focus();
            // Start the connection.

                
            //    var sessionId = $('#sessionId').val();
            //    //var name = 'fake name';
            //    game.server.addUserToGame(sessionId,name);
            //    $('#sendmessage').click(function () {                    
            //        game.server.sendUserResponse(sessionId, $('#message').val());
            //        $('#message').val('').focus();
            //    });

            //    $('#newChallenge').click(function () {
            //        game.server.sendChallenge();
            //    });

            //    $('#startGame').click(function () {
            //        game.server.startGame();
            //    });
                
            //    $('#getCategories').click(function () {
            //        game.server.getCategories();
            //    });


            //    $('#getCurrentCategory').click(function () {
            //        game.server.getCurrentCategory();
            //    });

            //    $('#setCategory').click(function () {
            //        game.server.setCategory($('#category').val());
            //    });

            //    $('#sendResponse').click(function () {
            //        game.server.sendResponse($('#sessionId').val(), $('#response').val());
            //    });

            //});
        });
        // This optional function html-encodes messages for display in the page.
        function htmlEncode(value) {
            var encodedValue = $('<div />').text(value).html();
            return encodedValue;
        }
    </script>
    <script src="http://static.opentok.com/v1.1/js/TB.min.js"></script>
    <script src="~/Scripts/bootstrap.js"></script>
    <script src="~/Scripts/sherlock.js"></script>
}
